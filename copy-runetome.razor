# Copy Runetome Script by Jaseowns
# UO Outlands - video coming soon...
# Requirements: two runetomes, one filled one blank - enough blank runes and regs to mark/recall
# By default the runelist is 26 long (full runetome)
# You can remove the list elements from runes_to_copy_list
# Additional Info:
#   This script removes a rune from your "from" runetome, recalls to that location
#   and use the description of that rune.  Once it recalls, it will attempt to Mark
#   a blank rune and rename based on that description
#   Assuming all goes well, it puts both runes back
#   WARNING: if your runes are unsafe locations, this may fail.
# References:
#   // marked rune
#   // recall rune 7956 0
#   // unmarked rune
#   // recall rune 7956 2882

removelist runes_to_copy_list
createlist runes_to_copy_list
# The entire runebook is 26 runes you can comment these out to prevent running all runes
pushlist runes_to_copy_list 1
pushlist runes_to_copy_list 2
pushlist runes_to_copy_list 3
pushlist runes_to_copy_list 4
pushlist runes_to_copy_list 5
pushlist runes_to_copy_list 6
pushlist runes_to_copy_list 7
pushlist runes_to_copy_list 8
pushlist runes_to_copy_list 9
pushlist runes_to_copy_list 10
pushlist runes_to_copy_list 11
pushlist runes_to_copy_list 12
pushlist runes_to_copy_list 13
pushlist runes_to_copy_list 14
pushlist runes_to_copy_list 15
pushlist runes_to_copy_list 16
pushlist runes_to_copy_list 17
pushlist runes_to_copy_list 18
pushlist runes_to_copy_list 19
pushlist runes_to_copy_list 20
pushlist runes_to_copy_list 21
pushlist runes_to_copy_list 22
pushlist runes_to_copy_list 23
pushlist runes_to_copy_list 24
pushlist runes_to_copy_list 25
pushlist runes_to_copy_list 26

if list runes_to_copy_list = 26 and counttype "recall rune" backpack 2882 < 26
    overhead "Cannot continue" 34
    overhead "You need at least 26 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 25 and counttype "recall rune" backpack 2882 < 25
    overhead "Cannot continue" 34
    overhead "You need at least 25 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 24 and counttype "recall rune" backpack 2882 < 24
    overhead "Cannot continue" 34
    overhead "You need at least 24 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 23 and counttype "recall rune" backpack 2882 < 23
    overhead "Cannot continue" 34
    overhead "You need at least 23 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 22 and counttype "recall rune" backpack 2882 < 22
    overhead "Cannot continue" 34
    overhead "You need at least 22 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 21 and counttype "recall rune" backpack 2882 < 21
    overhead "Cannot continue" 34
    overhead "You need at least 21 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 20 and counttype "recall rune" backpack 2882 < 20
    overhead "Cannot continue" 34
    overhead "You need at least 20 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 19 and counttype "recall rune" backpack 2882 < 19
    overhead "Cannot continue" 34
    overhead "You need at least 19 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 18 and counttype "recall rune" backpack 2882 < 18
    overhead "Cannot continue" 34
    overhead "You need at least 18 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 17 and counttype "recall rune" backpack 2882 < 17
    overhead "Cannot continue" 34
    overhead "You need at least 17 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 16 and counttype "recall rune" backpack 2882 < 16
    overhead "Cannot continue" 34
    overhead "You need at least 16 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 15 and counttype "recall rune" backpack 2882 < 15
    overhead "Cannot continue" 34
    overhead "You need at least 15 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 14 and counttype "recall rune" backpack 2882 < 14
    overhead "Cannot continue" 34
    overhead "You need at least 14 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 13 and counttype "recall rune" backpack 2882 < 13
    overhead "Cannot continue" 34
    overhead "You need at least 13 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 12 and counttype "recall rune" backpack 2882 < 12
    overhead "Cannot continue" 34
    overhead "You need at least 12 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 11 and counttype "recall rune" backpack 2882 < 11
    overhead "Cannot continue" 34
    overhead "You need at least 11 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 10 and counttype "recall rune" backpack 2882 < 10
    overhead "Cannot continue" 34
    overhead "You need at least 10 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 9 and counttype "recall rune" backpack 2882 < 9
    overhead "Cannot continue" 34
    overhead "You need at least 9 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 8 and counttype "recall rune" backpack 2882 < 8
    overhead "Cannot continue" 34
    overhead "You need at least 8 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 7 and counttype "recall rune" backpack 2882 < 7
    overhead "Cannot continue" 34
    overhead "You need at least 7 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 6 and counttype "recall rune" backpack 2882 < 6
    overhead "Cannot continue" 34
    overhead "You need at least 6 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 5 and counttype "recall rune" backpack 2882 < 5
    overhead "Cannot continue" 34
    overhead "You need at least 5 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 4 and counttype "recall rune" backpack 2882 < 4
    overhead "Cannot continue" 34
    overhead "You need at least 4 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 3 and counttype "recall rune" backpack 2882 < 3
    overhead "Cannot continue" 34
    overhead "You need at least 3 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 2 and counttype "recall rune" backpack 2882 < 2
    overhead "Cannot continue" 34
    overhead "You need at least 2 unmarked recall runes in your backpack" 88
    stop
elseif list runes_to_copy_list = 1 and counttype "recall rune" backpack 2882 < 1
    overhead "Cannot continue" 34
    overhead "You need at least 1 unmarked recall rune in your backpack" 88
    stop
endif

if counttype "recall rune" backpack 0 > 0
    overhead "Cannot continue" 34
    overhead "Please remove any marked runes from your bag" 88
    stop
endif

overhead "Select a runetome to copy FROM"
setvar runetome_copy_from
wait 500
overhead "Select a runetome to copy TO"
setvar runetome_copy_to


overhead "Beginning Copy..." 88

if not timerexists runes_to_copy_skill_check
    createtimer runes_to_copy_skill_check
    settimer runes_to_copy_skill_check 11000
endif

foreach rune_to_copy in runes_to_copy_list
    clearsysmsg
    if mana < 30
        while mana < 31
            overhead "Waiting for at least 30 mana..." 22
            if timer runes_to_copy_skill_check >= 11000
                useskill 'meditation'
                settimer runes_to_copy_skill_check 0
            endif
            wait 1000
        endwhile
    endif

    overhead "Pulling rune..." 88
    overhead rune_to_copy 144

    # Drop rune
    dclick runetome_copy_from
    waitforgump 167090027 1000
    gumpresponse 200
    waitforgump 167090027 1000
    gumpresponse 15
    wait 500

    if findtype "recall rune" backpack 0 as currentRune
        gumpclose 167090027
        getlabel currentRune runeDescription
        overhead runeDescription 88
        while not targetexists
            cast Recall
            wait 200
        endwhile
        target currentRune
        wait 1500
        if followers > 0
            say 'All guard me'
        endif
        while not targetexists
            cast Mark
            wait 200
        endwhile
        targettype "recall rune" backpack 2882
        lift currentRune
        drop runetome_copy_from 0 0 0
        wait 500

        if findtype "recall rune" backpack 0 as newRune
            overhead "Rename and move to new book" 88
            dclick newRune
            wait 500
            promptresponse runeDescription
            wait 500
            lift newRune
            drop runetome_copy_to 0 0 0
        else
            overhead "Warning!" 34
            overhead "Unable to find copied rune" 88
        endif
    else
        overhead "Might be done..." 88
    endif
endfor

overhead "Enjoy your copy!" 104
stop
