
# Generated on: 5/24/2024, 10:43:24 PM
# Generated by: https://www.outlandsbutler.com
#############################################
# Society Optimiser Crafting Queue Script Version 1.1.2W
#############################################
# INSTRUCTIONS:
# 1. Run this script in Razor
# 2. Fill in the quantities for each item
#
#
# DOUBLE CHECK THE ITEMS AND QUANTITIES
# If you notice any errors, please report them to the Outlands Butler Discord and 
# they will be fixed immediately (presuming I am awake)
#
#
#########
# Dont edit these, if you want to set them do it via the website.
# VARIABLES:
@setvar alchemyStockpile 0
@setvar inscriptionStockpile 0
@setvar blacksmithStockpile 0
@setvar tailoringStockpile 0
@setvar carpentryStockpile 0
@setvar tinkeringStockpile 0
@setvar waitForMe 1
#########
# Closes any existing crafting gump or queue gump
if gumpexists 949095101
  gumpclose 949095101
endif
if gumpexists 453554062
  gumpclose 453554062
endif

# Check for Resource Stockpile
# Opens Resource Stockpile and changes to Crafting Tool page
if findtype "resource container" ground -1 -1 2 as stocky
  dclick stocky
  waitforgump 1859005118
  gumpresponse 7 1859005118
  waitforgump 1859005118
else
  overhead 'I cant find your Resource Stockpile, move closer.' 53
  wait 2000
  replay
endif
#Alchemy
gumpclose 949095101
gumpresponse 100 1859005118
waitforgump 1859005118
if gumpexists 949095101
  @setvar! alchemyStockpile 1
endif
gumpclose 949095101
if alchemyStockpile = 0
    if findtype "mortar and pestle" backpack as alchemyTool
# skip
else
  overhead 'No Mortar and Pestle in backpack!' 34
  wait 2000
  replay
endif
endif
#Tailoring
gumpclose 949095101
gumpresponse 106 1859005118
waitforgump 1859005118
if gumpexists 949095101
  @setvar! tailoringStockpile 1
endif
gumpclose 949095101
if tailoringStockpile = 0
    if findtype "sewing kit" backpack as tailorTool
# skip
else
  overhead 'No Sewing Kit in backpack!' 34
  wait 2000
  replay
endif
endif

overhead "Tools available, lets get to work!" 88

# Opens Crafting Queue
whisper '[cq'
waitforgump 453554062
gumpresponse 5 453554062
waitforgump 453554062
if insysmsg "You are already at the maximum number of crafting queues allowed."
    overhead "Too many crafting queues, please delete a queue then start the script again" 34
    sysmsg "Too many crafting queues, please delete a queue then start the script again" 34
    stop
endif
wait 500

    # Alchemy
    if alchemyStockpile = 1
      if findtype "resource container" ground -1 -1 2
        gumpresponse 100 1859005118
        waitforgump 949095101
        overhead "Adding Alchemy Jobs" 88
      else
        overhead "I cant find your Resource Stockpile, move closer." 53
        wait 2000
        replay
      endif
    else
      if findtype "mortar and pestle" backpack as alchtool
        dclick alchtool
        waitforgump 949095101
        overhead "Adding Alchemy Jobs" 88
      else
        overhead "No Mortar and Pestle in backpack!" 34
        wait 2000
        replay
      endif
    endif
   
gumpresponse 101 949095101
waitforgump 949095101
gumpresponse 403 949095101
waitforgump 949095101
gumpresponse 402 949095101
waitforgump 949095101
gumpresponse 104 949095101
waitforgump 949095101
gumpresponse 402 949095101
waitforgump 949095101
gumpresponse 401 949095101
waitforgump 949095101
gumpresponse 109 949095101
waitforgump 949095101
gumpresponse 401 949095101
waitforgump 949095101
gumpresponse 9 949095101
waitforgump 949095101
gumpresponse 100 949095101
waitforgump 949095101
gumpresponse 400 949095101
waitforgump 949095101
gumpresponse 8 949095101
waitforgump 949095101
gumpresponse 106 949095101
waitforgump 949095101
gumpresponse 403 949095101
waitforgump 949095101
gumpresponse 402 949095101
waitforgump 949095101
gumpresponse 103 949095101
waitforgump 949095101
gumpresponse 402 949095101
waitforgump 949095101
gumpresponse 401 949095101
waitforgump 949095101

gumpclose 949095101




    # Tailoring
    if tailoringStockpile = 1
      if findtype "resource container" ground -1 -1 2
        gumpresponse 106 1859005118
        waitforgump 949095101
        overhead "Adding Tailoring Jobs" 88
      else
        overhead "I cant find your Resource Stockpile, move closer." 53
        wait 2000
        replay
      endif
    else
      if findtype "sewing kit" backpack as tailortool
        dclick tailortool
        waitforgump 949095101
        overhead "Adding Tailoring Jobs" 88
      else
        overhead "No Sewing Kit in backpack!" 34
        wait 2000
        replay
      endif
    endif
gumpresponse 100 949095101
waitforgump 949095101
# This is a dumb fix to prevent the issue of the gump mistaking recyle Regular for the material type
overhead "Changing material to Regular" 673
while not ingump "Dullhide" 949095101
gumpresponse 12 949095101
waitforgump 949095101
endwhile
gumpresponse 12 949095101
waitforgump 949095101
gumpresponse 100 949095101
waitforgump 949095101
gumpresponse 108 949095101
waitforgump 949095101
gumpresponse 403 949095101
waitforgump 949095101
gumpresponse 406 949095101
waitforgump 949095101
gumpresponse 101 949095101
waitforgump 949095101
gumpresponse 407 949095101
waitforgump 949095101
overhead "Changing material to Shadowhide" 673
gumpresponse 101 949095101
waitforgump 949095101
gumpresponse 100 949095101
waitforgump 949095101
while not ingump "Shadowhide" 949095101
gumpresponse 12 949095101
waitforgump 949095101
endwhile
gumpresponse 102 949095101
waitforgump 949095101
gumpresponse 402 949095101
waitforgump 949095101
gumpresponse 401 949095101
waitforgump 949095101
overhead "Changing material to Copperhide" 673
gumpresponse 101 949095101
waitforgump 949095101
gumpresponse 100 949095101
waitforgump 949095101
while not ingump "Copperhide" 949095101
gumpresponse 12 949095101
waitforgump 949095101
endwhile
gumpresponse 102 949095101
waitforgump 949095101
gumpresponse 404 949095101
waitforgump 949095101

gumpresponse 101
waitforgump 949095101
gumpresponse 100 949095101
waitforgump 949095101
overhead "Resetting Tailoring to Regular" 673
while not ingump "Dullhide" 949095101
gumpresponse 12 949095101
waitforgump 949095101
endwhile
gumpresponse 12 949095101
waitforgump 949095101
gumpclose 949095101








# Close Resource Stockpile
if gumpexists 1859005118
  gumpclose 1859005118
endif


if ingump "Page" 453554062
  while not ingump "1/" 453554062
    gumpresponse 8 453554062
    waitforgump 453554062
    wait 500
  endwhile
endif

# Recycle and Exceptional Setting
overhead "Setting Exceptional status and Recycling" 88
overhead "Ignore the system message errors, it be dumb" 53

if ingump "Page" 453554062
  while not ingump "1/" 453554062
    gumpresponse 8 453554062
    waitforgump 453554062
    wait 500
  endwhile
endif





    # Set Resource Stockpile as source
if findtype "resource container" ground -1 -1 2 as resStocky
overhead "Setting Resource Stockpile as source" 88
  gumpresponse 10 453554062
  waitfortarget
  waitforgump 453554062 
  wait 500
  target resStocky
  waitforgump 453554062
else
  overhead 'I cant find your Resource Stockpile, set queue resource source manually.' 53
  wait 2000
endif
wait 800


# Waiting for user to fill in quantities
  overhead "Lets fill in the quantities together" 88
  overhead "Lets fill in the quantities together" 88
  overhead "Lets fill in the quantities together" 88
gumpresponse 500 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 500 then press confirm" 169
  sysmsg "Enter quantity 500 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 501 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 22 then press confirm" 179
  sysmsg "Enter quantity 22 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 502 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 500 then press confirm" 169
  sysmsg "Enter quantity 500 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 503 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 22 then press confirm" 179
  sysmsg "Enter quantity 22 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 504 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 16 then press confirm" 169
  sysmsg "Enter quantity 16 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 9 453554062
waitforgump 453554062
wait 500
gumpresponse 500 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 15 then press confirm" 179
  sysmsg "Enter quantity 15 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 501 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 150 then press confirm" 169
  sysmsg "Enter quantity 150 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 502 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 24 then press confirm" 179
  sysmsg "Enter quantity 24 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 503 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 125 then press confirm" 169
  sysmsg "Enter quantity 125 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 504 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 6 then press confirm" 179
  sysmsg "Enter quantity 6 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 9 453554062
waitforgump 453554062
wait 500
gumpresponse 500 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 11 then press confirm" 169
  sysmsg "Enter quantity 11 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 501 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 6 then press confirm" 179
  sysmsg "Enter quantity 6 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 502 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 17 then press confirm" 169
  sysmsg "Enter quantity 17 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 503 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 42 then press confirm" 179
  sysmsg "Enter quantity 42 then press confirm" 179
  wait 1000
endwhile
wait 500
gumpresponse 504 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 8 then press confirm" 169
  sysmsg "Enter quantity 8 then press confirm" 169
  wait 1000
endwhile
wait 500
gumpresponse 9 453554062
waitforgump 453554062
wait 500
gumpresponse 500 453554062
waitforgump 453554062
waitforgump 3239880667
while gumpexists 3239880667
  overhead "Enter quantity 24 then press confirm" 179
  sysmsg "Enter quantity 24 then press confirm" 179
  wait 1000
endwhile
wait 500
overhead "All done! PLEASE double check the items and quantities." 153
if ingump "Page" 453554062
  while not ingump "1/" 453554062
    gumpresponse 8 453554062
    waitforgump 453554062
    wait 500
  endwhile
endif


# Overhead all items and quantities
sysmsg "Here are your job quantities:" 319
sysmsg "500 x Greater Cure Potion(x25)" 48
sysmsg "22 x Greater Cure Potion" 48
sysmsg "500 x Greater Agility Potion(x25)" 48
sysmsg "22 x Greater Agility Potion" 48
sysmsg "16 x Superior Growth Serum" 48
sysmsg "15 x Superior Fertility Serum" 48
sysmsg "150 x Greater Poison Potion(x25)" 48
sysmsg "24 x Greater Poison Potion" 48
sysmsg "125 x Greater Strength Potion(x25)" 48
sysmsg "6 x Greater Strength Potion" 48
sysmsg "11 x Copperhide Quiver" 48
sysmsg "6 x Rosehide Quiver" 48
sysmsg "17 x Leather Chest" 48
sysmsg "42 x Shadowhide Studded Cap" 48
sysmsg "8 x Shadowhide Studded Gloves" 48
sysmsg "24 x Copperhide Studded Legs" 48



# Important Warning
sysmsg "---------------" 153
overhead "DOUBLE CHECK ITEMS AND QUANTITIES" 34
overhead "If you spot any errors, tell me in Butler discord and they will be fixed immediately." 34
sysmsg "---------------" 153
sysmsg "DOUBLE CHECK ITEMS AND QUANTITIES" 34
sysmsg "If you spot any errors, tell me in Butler discord and they will be fixed immediately." 34

